require=function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){var c,d,e;c=window.$,a("infinite-swipe"),e=a("./itemManager.coffee").omitItem,d=function(){function a(a){var b,c,d;this.options=a,null==(b=this.options).total&&(b.total=Number(this.options.$wrap.attr("data-total"))),null==(c=this.options).item_total&&(c.item_total=Number(this.options.$wrap.attr("data-item_total"))),null==(d=this.options).item_count&&(d.item_count=Number(this.options.$wrap.attr("data-item_count"))),this.initSwipe(this.options.$wrap),this.initThumbnailChecker(this.options.$wrap)}return a.prototype.options={$wrap:null,total:null,item_total:null,item_count:null,onPage:null},a.prototype.onPage=function(a){return this.options.onPage=a},a.prototype.initSwipe=function(a){return this.options.total>1?a.find(".list").infiniteSwipe("destroy").infiniteSwipe({$target_wrap:a.find(".target-wrap"),$target:a.find(".target"),total:this.options.total,$prev:a.find(".prev"),$next:a.find(".next"),$curr:a.find(".current-page"),infinite:"true"===a.attr("data-infinite"),animation_type:a.attr("data-animation_type"),autoswipe_seconds:Number(a.attr("data-autoswipe_seconds")),$autoswipe_pause_el:a,onPage:function(a){return function(b){return a.setPage(b),a.options.onPage?a.options.onPage(b):void 0}}(this)}):a.find(".prev, .next").addClass("disabled"),this.setPage(1)},a.prototype.initThumbnailChecker=function(a){var b,d,f;return b=a.find(".target"),d=a.find(".target:not(.infinite-swipe-target-clone)"),f=function(){var b;return b=c(this).parents(".item"),e(a,b)},d.find("img.thumbnail").on("error",f),d.find("img[err]").each(f)},a.prototype.setPage=function(a){var b,d,e,f,g,h;if(h=this,b=this.options.$wrap,d=b.find(".page-positions"),d.length>0){for(d.html("").data("page",a),e=f=0,g=this.options.total;g>=0?g>f:f>g;e=g>=0?++f:--f)d.append(c("<span class='page-position' data-page='"+(e+1)+"'>"+("<span class='page-position-num' data-page='"+(e+1)+"'>"+(e+1))+"</span></span>"));d.find(".page-position").eq(a-1).addClass("current"),d.find(".page-position").on("click",function(){return a=c(this).data("page"),b.find(".list").trigger("swipe_page",a),h.setPage(a)})}return b.trigger("page",a)},a}(),b.exports=d},{"./itemManager.coffee":8,"infinite-swipe":"infinite-swipe"}],2:[function(a,b){var c,d,e,f,g;c=window.$,e=a("./thumbnailManager.coffee").adjustImgRatioTo16x10,f=a("./frameSynchronizer.coffee"),d=[{campaign_id:"YWAnNmwgyHOP",content_id:"k8nlNNWyQTLg",method:"90.1.0",zoneid:"639198",service_types:["blog","blog_m","community","community_m"]},{campaign_id:"jZmxNkKxKHRW",content_id:"QnpQB80M6Fkv",method:"90.1.0",zoneid:"691634",service_types:["news","news_m","magazine","magazine_m"]}],g=function(a){var b,g,h,i,j,k,l,m,n;if(n=a.widget_id,l=a.service_name,m=a.service_type,b=a.ad_exposelog_links,!(null!=b?b.length:void 0)||window.location.search.indexOf("&ad_campaign_id=")>-1)return void f.setAdExchangeFilled();for(g="_dbl_pc_"+parseInt(1e5*Math.random()),j=function(a){var d,h;return window[g]=function(d){var g,h,i,j,k,l,m,n,o,p,q,r,s,t;if(0!==d.response_status)return void f.setAdExchangeFilled();for(p=d.products[0],t=p.title,o=p.price,g=p.click_url,j=p.image,k=d.impression_pixels,s=(null!=(q=d.advertiser)?q.description:void 0)||"A&#x200b;D",m=a.method,c(".target").each(function(){var b,d;return b=c(this).find(".item-sp:first"),d=b.find(".name"),d.text(t),b.find(".thumbnail").attr("src",j.url).removeAttr("style"),b.find(".thumbnail").data("org-src")?b.find(".thumbnail").data("org-src",j.url):e(b.find(".thumbnail")),b.find(".sp-mark-custom").html(s),b.find("a").attr("href",b.find("a").attr("href").replace(/campaigns\/[^\/]+/,"campaigns/"+a.campaign_id).replace(/contents\/[^\/]+/,"contents/"+a.content_id).replace(/method=[^\&]+/,"method="+m)+("&custom_link_url="+encodeURIComponent(g)))}),h=b[0].replace(/campaigns\/[^\/]+/,"campaigns/"+a.campaign_id).replace(/contents\/[^\/]+/,"contents/"+a.content_id).replace(/method=[^\&]+/,"method="+m),b[0]=h,r=h.replace("/expose","/request"),c.getJSON(r+"&callback=?",function(){}),i=0,l=k.length;l>i;i++)n=k[i],c("body").append("<img width='0' height='0' alt='' src='"+n.url+"' style='display:none'>");return f.setAdExchangeFilled()},h=document.createElement("script"),h.type="text/javascript",h.src="//cas.criteo.com/delivery/0.1/napi.jsonp?zoneid="+a.zoneid+("&callback="+g+"&publisherid="+encodeURIComponent(l)),d=document.getElementsByTagName("script")[0],d.parentNode.insertBefore(h,d)},i=0,k=d.length;k>i;i++)if(h=d[i],c.inArray(m,h.service_types)>-1)return void j(h)},b.exports={init:g}},{"./frameSynchronizer.coffee":6,"./thumbnailManager.coffee":14}],3:[function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;c=window.$,g=a("./frameSynchronizer.coffee"),n=a("./itemManager.coffee").omitItem,r=window.localStorage,j=function(a){return function(b){var c;return r&&(c=r.getItem(a+":"+b)),(null!=c?c.length:void 0)?c.split("|||"):[]}},q=function(a){return function(b,c){return r?r.setItem(a+":"+b,c.join("|||")):void 0}},i=j("dable_block_item"),p=q("dable_block_item"),h=j("dable_block_ad"),o=q("dable_block_ad"),f=function(a){var b,d,e,f;return f=a.service_name,b=a.$wrap,e=i(f),d=h(f),0===e.length&&0===d.length?b:(b.find(".item").each(function(){var a,f,g;return a=c(this),g=a.attr("data-item_id"),f=a.attr("data-ad_id"),g&&e.indexOf(g)>-1?n(b,a):f&&d.indexOf(f)>-1?n(b,a):void 0}),b)},m='<div class="block-item-message-wrap"\n  <div class="block-item-message">\n    해당콘텐츠는 추천에서 제외됩니다.\n  </div>\n</div>',e=function(a){return function(b){var d,e,f,g,h;return b.preventDefault(),e=a.$wrap,h=a.service_name,d=c(this).parents(".item"),g=d.attr("data-item_id"),n(e,d,{messagebox:m}),f=i(h),g&&-1===f.indexOf(g)&&(f.push(g),p(h,f)),10===f.length?c.ajax({method:"POST",url:"/util/exclude_item_count",data:{service_name:h}}):void 0}},d=function(a){return function(b){var d,e,f,g,i;return b.preventDefault(),e=a.$wrap,i=a.service_name,d=c(this).parents(".item"),f=d.attr("data-ad_id"),n(e,d,{messagebox:m}),g=h(i),f&&-1===g.indexOf(f)&&(g.push(f),o(i,g)),10===g.length?c.ajax({method:"POST",url:"/util/exclude_ad_count",data:{service_name:i}}):void 0}},l=function(a){var b,c,g;return c=a.from,g=a.service_name,b=a.$wrap,b=f(a),b.find(".item:not(.item-sp) .block-btn-wrap").on("click",e(a)),b.find(".item-sp .block-btn-wrap").on("click",d(a))},k=function(a){return c(window).on("onload_responsive_group",function(){return l(a)}),l(a)},b.exports={init:k}},{"./frameSynchronizer.coffee":6,"./itemManager.coffee":8}],4:[function(a,b){var c,d,e;c=window.$,d=a("./frameSynchronizer.coffee"),e=function(a){var b;return b=a.from,c(".powered-by, .sp-info a").on("click",function(a){return 0===b.indexOf("http")?(a.preventDefault(),d.sendPostMessage({from:b,show_dable_popup:"1"})):void 0})},b.exports={init:e}},{"./frameSynchronizer.coffee":6}],5:[function(a,b){var c,d,e,f,g;c="6049845540285",d="481869948690673",g=function(a){var b,c,e,f,g;return e=a.content_name,b=a.content_category,c=a.content_id,f=encodeURIComponent,g=document.createElement("img"),g.src="https://www.facebook.com/tr?id="+d+("&ev=ViewContent&cd[content_name]="+f(e))+("&cd[content_category]="+f(b))+"&cd[content_type]=product&cd[content_ids]="+f(c),document.body.appendChild(g)},f=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o;for(n=(null!=a?a.split("/"):void 0)||[],k=n[4],b=n[8],c=n[10],m=(null!=a&&null!=(h=a.split("?"))&&null!=(i=h[1])?i.split("&"):void 0)||[],l={},e=0,g=m.length;g>e;e++)d=m[e],j=d.split("="),f=j[0],o=j[1],l[f]=o;return{content_name:k,content_category:l.channel,content_id:b+"-"+c}},e=function(){return $("body").on("click",".item-sp a",function(){var a;return a=$(this).attr("href"),g(f(a))})},b.exports={init:e}},{}],6:[function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o;c=window.$,n=a("./simplePostMessage.js"),d=a("./ga.coffee"),h=!1,g=!1,j=function(a,b){return a.replace(new RegExp("^.*"+b+"=([^&]+).*$"),"$1")},l=function(a){var b,c,d;b=a.from,d=[];for(c in a)"from"!==c&&d.push(c+"="+a[c]);return 0===b.indexOf("http")?n.postMessage(d.join("&"),b):void 0},i=function(a,b){var d,e;null==b&&(b=0),d=c("img.thumbnail:visible"),d.length>0&&0===d.height()&&10>b?setTimeout(function(){return i(a,b+1)},100):(e=c("body").outerHeight(!0)||1,a(e))},k=function(a,b){var d,e,f,g;for(a&&(a=a.replace(/^https?:/,""),c.get(a,function(){})),f=[],d=0,e=b.length;e>d;d++)g=b[d],-1!==g.indexOf("page=1")&&(g=g.replace(/^https?:/,""),f.push(c.getJSON(g+"&callback=?",function(){})));return f},o=function(a){return i(function(b){return a.if_height=b,l(a)})},e=function(a){var b,e,f,j,m,p,q,r,s,t,u,v,w,x,y;return x=a.service_name,t=a.messages,m=a.exposelog_link,b=a.ad_exposelog_links,e=a.ads,q=a.ga_sample_rate,s=a.is_secret_widget,v=a.pre_expose,r=t.id,p=t.from,y=t.sliding,y&&(l({id:r,from:p,sliding:y}),delete t.sliding),c(window).on("syncheight",function(){return o({id:r,from:p})}),c(window).on("load",function(){var a;return i(function(a){return t.if_height=a,t.has_recom=a>1&&1||0,l(t)}),a=function(){return setTimeout(function(){return g?o({id:r,from:p,init:"1"}):a()},300)},a(),setTimeout(function(){return o({id:r,from:p}),c(window).on("orientationchange resize",function(){return o({id:r,from:p})})},3e3)}),-1===window.location.href.indexOf("test=1")&&(j=[1],c(".recommendations").on("page",function(a,d){var e,f,g,h,i,k,l;for(e=0,g=j.length;g>e;e++)if(i=j[e],Number(d)===i)return;for(j.push(Number(d)),k=[],f=0,h=b.length;h>f;f++)l=b[f],-1!==l.indexOf("&page="+d)&&(l=l.replace(/^https?:/,""),k.push(c.getJSON(l+"&callback=?",function(){})));return k})),v&&setTimeout(function(){return c(window).trigger("pre-expose")},0),w=!1,f=function(){return!h||window.location.href.indexOf("test=1")>-1||s&&!w?void 0:(c(window).trigger("expose"),k(m,b),d.sendGaExposeLog(x,e,q),d.attachGaUidToClickLinks())},u=function(a){var b;return b=a.data,b.indexOf("update_height")>-1?o({id:r,from:p}):b.indexOf("expose")>-1&&-1===b.indexOf("pre_expose")?(h=!0,f()):b.indexOf("show_secret_widget")>-1?(h=!0,w=!0,f()):b.indexOf("pre_expose")>-1&&!v?c(window).trigger("pre-expose"):void 0},n.receiveMessage(u)},f=function(){return h},m=function(){return g=!0},b.exports={init:e,sendPostMessage:l,sendExposeLog:k,isAdExposed:f,setAdExchangeFilled:m}},{"./ga.coffee":7,"./simplePostMessage.js":12}],7:[function(a,b){var c,d,e,f;d=function(){return window.ga?void 0:function(a,b,c,d,e,f,g){return a.GoogleAnalyticsObject=e,a[e]=a[e]||function(){return(a[e].q=a[e].q||[]).push(arguments)},a[e].l=1*new Date,f=b.createElement(c),g=b.getElementsByTagName(c)[0],f.async=1,f.src=d,g.parentNode.insertBefore(f,g)}(window,document,"script","//www.google-analytics.com/analytics.js","ga")},e=function(a){return d(),ga(function(){return a(ga.getAll()[0].get("clientId"))})},c=function(){return e(function(a){return $(".item-sp a").each(function(){var b;return b=$(this).attr("href"),-1===b.indexOf("sp-api")||b.indexOf("ga_uid")>-1?void 0:(b+="&ga_uid="+a,$(this).attr("href",b))})})},f=function(a,b,c){var e,f,g,h,i;if(null==c&&(c=5),d(),null!=b?b.length:void 0){for(ga("create","UA-64397972-5","auto",{name:"dableadexpose",sampleRate:c}),i=[],g=0,h=b.length;h>g;g++)e=b[g],f={},f.dimension1=a,f.dimension2=e.campaign_id,f.dimension3=e.content_id,i.push(ga("dableadexpose.send","pageview",f));return i}},b.exports={attachGaUidToClickLinks:c,sendGaExposeLog:f}},{}],8:[function(a,b){var c,d,e,f,g;e=function(a){return"TR"===a.parent().prop("tagName")?a.prop("className","empty").html("&nbsp;"):a.remove()},c=function(a){var b;return b=a.find("img.thumbnail").attr("data-org-src"),b?a.find("img.thumbnail").attr("src",b):void 0},f=function(a,b,c){var d,e,f,g;return null==c&&(c={}),e=null!=(g=c.messagebox)?g:!1,e?(f=b.parent().prop("tagName"),d=$(e),b.html(d),setTimeout(function(){return b.fadeOut("slow",function(){return b.replaceWith(a),a.fadeIn("slow")})},1e3)):b.replaceWith(a)},d=function(a){var b,c,d;return d=a.find(".list-sub"),b=d.find('.item-sub:not(:has([err="1"]))').not(".empty").eq(0),b.length?(c=b.clone({deepWithDataAndEvents:!0}),b.remove()):c=null,c},g=function(a,b,g){var h,i,j;return null==g&&(g={}),i=b.attr("data-idx"),j=a.attr("data-item_total"),i.indexOf("sub")>-1?void e(b):(h=d(a),a.find(".target").each(function(){var a,d,k,l,m,n,o,p,q,r;if(l=$(this),b=l.find(".item[data-idx="+i+"]"),h)return d=h,c(d),d.attr("data-idx",i),f(d,b,g);for(a=null,r=Number(i)+1,m=Number(j),n=o=p=m,q=r;q>=p?q>=o:o>=q;n=q>=p?++o:--o)if(k=l.find(".item[data-idx="+n+"]"),k.length&&!k.has("[err=1]").length){a=k;break}return(null!=a?a.length:void 0)>0?(d=a.clone({deepWithDataAndEvents:!0}),d.attr("data-idx",i),e(a),c(d),f(d,b,g)):e(b)}),0===a.find(".item").length?$("body").html(""):void 0)},b.exports={omitItem:g}},{}],9:[function(a,b){var c,d,e,f,g,h,i;c=window.$,i=a("./recommendations.coffee"),g=function(a,b){var c,d;if((null!=a?a.length:void 0)&&a.text()!==String(b))return d=function(b){return a.text(b)},c=function(a,c){return setTimeout(function(){return d(Math.max(0,b+a))},c)},c(4,50),c(-3,100),c(3,150),c(-2,200),c(2,250),c(-1,325),c(1,400),c(0,500)},d=c(".realtime-refresh-counter"),e=c(".realtime-refresh-counter-value"),f=function(){function a(a){var b;this.item_id=a.item_id,this.service_name=a.service_name,this.settings_group=a.settings_group,this.post_param=a.post_param,this.$list=c(".list");try{this.$list.mixItUp({layout:{display:"block"}})}catch(d){b=d}this.updateCount()}return a.prototype.startTimer=function(a){var b,c;if(!(0>=a))return b=10,(c=function(f){return function(){return d.attr("data-count",b),e.text(b),b--,b>=0?setTimeout(c,1e3):(f.updateCount(),f.updateRecommendations(),setTimeout(function(){return f.startTimer(a-1)},1e3))}}(this))()},a.prototype.updateCount=function(){var a;return a=encodeURIComponent,c.getJSON("/items/services/"+a(this.service_name)+"/id/"+a(this.item_id)+"/recent_user_count").done(function(a){var b,d;return b=(null!=a&&null!=(d=a.result)?d.count:void 0)||0,g(c(".realtime-count-value"),Math.max(1,b))})},a.prototype.updateRecommendations=function(){var a,b;return b=function(a,b){return b.before(a),a.slideDown(500)},a=this.$list,i.read({item_id:this.item_id,responsive_group:this.responsive_group,post_param:this.post_param,settings_group:this.settings_group,nolog:!0,nocache:!0}).then(function(b){var d,e,f,g;d=a.find(".item"),e=b.find(".list .item:not(.item-sp)"),g=d.length-1,e.each(function(){var b,e,f,h,i;return h=c(this).data("item_id"),f=d.filter("[data-item_id='"+h+"']"),f.length>0?(i=c(this).find(".item-score-number").text(),f.attr("data-item_score",i).find(".item-score-number").text(i)):(e=c(this).clone(),b=function(){for(var a;;)if(a=d.eq(g),g--,!(null!=a?a.hasClass("item-sp"):void 0))return a}(),b.replaceWith(e)),d=a.find(".item")}),a.find(".item-sp").each(function(){var a;return c(this).attr("data-item_score",(null!=(a=c(this).next())?a.attr("data-item_score"):void 0)||0)});try{return a.mixItUp("sort","item_score:desc")}catch(h){f=h}})},a}(),h=function(a){return new f(a)},b.exports={init:h,Counter:f}},{"./recommendations.coffee":10}],10:[function(a,b){var c,d,e,f;c=window.$,d={},f=function(a){var b,e,f,g,h,i,j,k,l,m;return f=a.item_id,k=a.responsive_group,h=a.nolog,i=a.post_param,l=a.settings_group,g=null!=(j=a.nocache)?j:!1,b=f+"--"+k,d[b]&&!g?c.when(d[b]):(m=window.location.href,m=m.replace(/\&client_width=[0-9]+/,""),-1===m.indexOf("?")&&(m+="?"),i?(e=c.extend({},i),f&&(e.item_id=f),null!=k&&(e.responsive_group=k),h&&(e.nolog=1),e.abtest_index=l,m=m.replace("?","/recommendations?"),c.when(c.post(m,e)).then(function(a){var e;return e=c(a),d[b]=e,e})):(f&&(m.indexOf("item_id=")>-1?m=m.replace(/item_id=[^\&]*/,"item_id="+f):m+="&item_id="+f),null!==k&&(m+="&responsive_group="+k),h&&(m+="&nolog=1"),m+="&abtest_index="+l,m=m.replace("?","/recommendations?"),c.when(c.get(m)).then(function(a){var e;return e=c(a),d[b]=e,e})))},e=function(a,b,c){var e;return e=a+"--"+b,d[e]=c.clone()},b.exports={read:f,cache:e}},{}],11:[function(a,b){var c,d,e,f;c=window.$,f=null,d=function(a,b){var d,e,g,h,i,j,k;for(k=c("body").width(),i=null,e=d=0,g=a.length;g>d;e=++d)if(h=a[e],k>(h.min_width||0)&&k<(h.max_width||9999)){i=e;break}return j=f!==i,f=i,b(j,i)},e=function(a,b,e){var g;return null==b&&(b=null),f=b,d(a,e),g=null,c(window).on("resize orientationchange",function(){return g&&clearTimeout(),g=setTimeout(function(){return d(a,e),clearTimeout(g),g=null},300)})},b.exports={init:e}},{}],12:[function(a,b){var c={};!function(a){"$:nomunge";var b,c,d,e,f=1,g=!1,h="postMessage",i="addEventListener",j=window[h];"undefined"!=typeof window.opera&&window.opera.version&&9==parseInt(window.opera.version())&&Event.prototype.__defineGetter__("origin",function(){return"http://"+this.domain}),a[h]=function(a,b,c){b&&(a=encodeURIComponent("string"==typeof a?a:JSON.stringify(a)),c=c||parent,j?c[h](a,b.replace(/([^:]+:\/\/[^\/]+).*/,"$1")):b&&(c.location=b.replace(/#.*$/,"")+"#"+ +new Date+f++ +"&"+a))},a.receiveMessage=e=function(a,f,h){j?(a&&(d&&e(),d=function(b){if("string"==typeof f&&b.origin!==f||"function"==typeof f&&f(b.origin)===g)return g;var c={};for(var d in b)c[d]=b[d];c.data=decodeURIComponent(c.data);try{c.data=JSON.parse(c.data)}catch(e){}a(c)}),window[i]?window[a?i:"removeEventListener"]("message",d,g):window[a?"attachEvent":"detachEvent"]("onmessage",d)):(b&&clearInterval(b),b=null,a&&(h="number"==typeof f?f:"number"==typeof h?h:100,b=setInterval(function(){var b=document.location.hash,d=/^#?\d+&/;b!==c&&d.test(b)&&(c=b,a({data:b.replace(d,"")}))},h)))}}(c),b.exports=c},{}],13:[function(a,b){var c,d,e;c=window.$,d=a("./frameSynchronizer.coffee"),e=function(a){var b,c,e;return b=a.from,c=a.id,e=a.secret_top_offset,d.sendPostMessage({from:b,id:c,secret_top_offset:e})},b.exports={init:e}},{"./frameSynchronizer.coffee":6}],14:[function(a,b){var c,d;c=function(a){var b;return b=function(){var a,c,d,e;return this.complete?(a=$(this),e=a.width(),c=a.height(),d=a.parent().height(),d>=c?(e=parseInt(e*d/c,10),a.css({width:e+"px",height:d+"px"})):1.2>e/c&&e/c>.35&&400>=e?(e=parseInt(e*(e/c/1.2),10),a.css({width:e+"px"})):void 0):setTimeout(function(a){return function(){return b.apply(a)}}(this),100)},a.each(b)},d=function(a){var b,d,e;return e=a.thumbnail_fix_16x10,b=$(".recommendations"),d=function(a){var b;return b=$('[data-page="'+a+'"] img[data-org-src]'),b.each(function(){var a;return a=$(this).data("org-src"),$(this).attr("src",a).removeAttr("data-org-src")}),e?c(b):void 0},$(window).on("pre-expose expose check-thumbnail",function(){return d(1)}),b.on("page",function(a,b){return d(b)}),e&&c($("img.thumbnail:not([data-org-src])")),window.top===window&&d(1),document.documentMode&&document.documentMode<=7?$("body").on("click",".thumbnail",function(a){return a.preventDefault(),$(this).parents(".item-link").get(0).click()}):void 0},b.exports={init:d,adjustImgRatioTo16x10:c}},{}],15:[function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;b=window.$,a("infinite-swipe"),c=a("./lib/Widget.coffee"),m=a("./lib/recommendations.coffee"),k=a("./lib/frameSynchronizer.coffee"),o=a("./lib/responsiveManager.coffee"),q=a("./lib/thumbnailManager.coffee"),p=a("./lib/slidingManager.coffee"),l=a("./lib/realtimeCounter.coffee"),j=a("./lib/fbPixel.coffee"),i=a("./lib/dablePopup.coffee"),h=a("./lib/blockItem.coffee"),d=a("./lib/adFiller.coffee"),e=function(){var a,c;return a=b(".thumbnail").eq(0),c=a.length?a.offset().top+a.height()/2-20:50,b(".prev, .next").css("top",c)},f=function(){var a,c;if(b(".selfitems").length){switch(c=b(".selfitems").data("selftype")){case"cart":a="131.1.1";break;case"buy":a="132.1.1";break;default:a="130.1.1"}return b(".selfitems a").each(function(){var c,d,e,f,g;return c=b(this),c.attr("href").indexOf("click_redirect")>-1?void 0:(c.data("orglink")||c.data("orglink",c.attr("href")),f=c.data("orglink"),e=c.parents(".item").data("item_id"),g=b(".recommendations a").attr("href"),d=function(){var b;return b=g,b=b.replace(/\&pick=[^\&]+/,"&pick="+e),b=b.replace(/\&cm=[^\&]+/,"&cm="+a),b=f?b.replace(/\&url=[^\&]+/,"&url="+f):b.replace(/\&url=[^\&]+/,"")}(),c.attr("href",d))})}},g=function(){var a,c,d,e,f;if(b(".selfitems").length)return a=parseInt(b(".recommendations .target-wrap").attr("data-item_count"),10),d=b(window).width(),c=parseInt(b(".list").css("margin-left"))+parseInt(b(".list").css("margin-right")),e=100*(c*a+d-c)/(a+1)/d,f=100-e,b(".selfitems").css("width",parseInt(100*e-10)/100+"%"),b(".recommendations").css("width",parseInt(100*f-10)/100+"%")},n=function(a,d){var h,i,j,k,l,n,o;return h=a.item_id,n=a.responsive_group,i=null!=(k=a.nolog)?k:!1,j=a.post_param,o=null!=(l=a.settings_group)?l:0,b(".recommendations").addClass("loading"),m.read({item_id:h,responsive_group:n,post_param:j,settings_group:o,nolog:i}).then(function(a){var h,i,j;return h=b(".recommendations"),a.find(".list-sub").length?(h.find(".list-sub").html("").replaceWith(a.find(".list-sub").clone()),h.find(".list").infiniteSwipe("destroy").html("").replaceWith(a.find(".list").clone())):h.find(".list").infiniteSwipe("destroy").html("").replaceWith(a.find(".list").clone()),i=h.find(".target-wrap"),j=Math.ceil(Number(i.attr("data-data_count"))/Number(i.attr("data-item_count"))),h.find(".total").text(j),new c({$wrap:h,total:j}),b(".recommendations").removeClass("loading"),null!=n?b(".widget").attr("data-responsive-group",n+1):b(".widget").attr("data-responsive-group",0),f(),g(),e(),b(window).trigger("syncheight").trigger("onload_responsive_group"),d?d():void 0})},window.initWidgetPage=function(a){var m,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N;return N=a.widget_id,J=a.service_name,K=a.service_type,B=a.item_id,s=a.ads,C=a.messages,u=a.exposelog_link,D=a.post_param,r=a.ad_exposelog_links,v=a.ga_sample_rate,L=a.settings_group,x=a.init_responsive_group,z=a.is_realtime_widget,A=a.is_secret_widget,I=a.secret_top_offset,M=a.thumbnail_fix_16x10,E=a.pre_expose,y=a.is_block_item,H=a.responsive,G=x,(null!=H?H.length:void 0)>0&&o.init(H,G,function(a,c){return G=c,a?n({item_id:null,responsive_group:c,nolog:!0,post_param:D,settings_group:L},function(){return b(".widget").css("opacity",1)}):b(".widget").css("opacity",1)}),m=b(".selfitems"),w=m.length>0,w&&(new c({$wrap:m,onPage:function(a){return B=b(".selfitems [data-idx="+(a-1)+"]").attr("data-item_id"),n({item_id:B,responsive_group:G,nolog:!1,post_param:D})}}),f(),g()),F=null,b(window).on("pre-expose load resize orientationchange",function(){return F&&clearTimeout(F),F=setTimeout(function(){return w&&g(),e(),b(window).trigger("syncheight"),F=null},100)}),new c({$wrap:b(".recommendations")}),e(),z&&(t=new l.Counter({service_name:J,item_id:B,settings_group:L,post_param:D}),b(window).on("expose",function(){return t.startTimer(15)})),A&&p.init({id:C.id,from:C.from,secret_top_offset:I}),k.init({service_name:J,ads:s,messages:C,exposelog_link:u,ad_exposelog_links:r,ga_sample_rate:v,is_secret_widget:A,pre_expose:E}),j.init(),q.init({thumbnail_fix_16x10:M}),i.init({from:C.from}),y&&h.init({from:C.from,service_name:J,$wrap:b(".recommendations")}),d.init({widget_id:N,service_name:J,service_type:K,ad_exposelog_links:r})}},{"./lib/Widget.coffee":1,"./lib/adFiller.coffee":2,"./lib/blockItem.coffee":3,"./lib/dablePopup.coffee":4,"./lib/fbPixel.coffee":5,"./lib/frameSynchronizer.coffee":6,"./lib/realtimeCounter.coffee":9,"./lib/recommendations.coffee":10,"./lib/responsiveManager.coffee":11,"./lib/slidingManager.coffee":13,"./lib/thumbnailManager.coffee":14,"infinite-swipe":"infinite-swipe"}],"infinite-swipe":[function(a,b,c){!function(b){"use strict";"function"==typeof define&&define.amd?define(["jquery"],b):b("object"==typeof c?a("jquery"):jQuery)}(function(a){"use strict";var b=function(){for(var a=document.createElement("div"),b="transform WebkitTransform MozTransform OTransform msTransform".split(" "),c="transition WebkitTransition MozTransition OTransition msTransition".split(" "),d=0;d<b.length;d++)if(void 0!==a.style[b[d]]&&void 0!==a.style[c[d]])return!0;return!1}(),c=function(a,c,d){b?a.css({"-webkit-transform":"translate3D("+c+"px, 0, 0)","-moz-transform":"translate3D("+c+"px, 0, 0)","-ms-transform":"translate3D("+c+"px, 0, 0)","-o-transform":"translate3D("+c+"px, 0, 0)",transform:"translate3D("+c+"px, 0, 0)"}):a.css("opacity",.7).animate({"margin-left":t+"px",opacity:1},d.transition_ms)},d=function(b,c,d){b.animate({opacity:0},d.transition_ms,function(){a(this).css({"margin-left":c+"px"}),a(this).animate({opacity:1})})},e=function(a,b){a.css({"margin-left":b+"px"})},f=function(a){switch(a){case"none":return e;case"slide":return c;case"fadeIn":return d;default:return c}},g=function(b,c){c=a.extend({$target_wrap:null,$target:null,$prev:null,$next:null,$curr:null,$autoswipe_pause_el:null,total:1,transition_ms:null,animation_type:"slide",infinite:!1,autoswipe_seconds:0,onPage:null},c),null===c.transition_ms&&(c.transition_ms="slide"===c.animation_type?200:0),this.$el=b,this.$target_wrap=c.$target_wrap||b,this.$target=c.$target||b,this.$autoswipe_pause_el=c.$autoswipe_pause_el||b,this.p=1,this.offset=0,this.total=c.total,this.curr_px=0,this.disabled_touch=!1,this.options=c,this.init()};g.prototype={_setTransitionDuration:function(a){var b=this.$target_wrap.get(0);b.style.webkitTransitionDuration=a+"ms",b.style.mozTransitionDuration=a+"ms",b.style.msTransitionDuration=a+"ms",b.style.oTransitionDuration=a+"ms",b.style.transitionDuration=a+"ms"},init:function(){if(this.$el.addClass("infinite-swipe-stage"),this.$target_wrap.addClass("infinite-swipe-target-wrap"),this._setTransitionDuration(this.options.transition_ms),this.$target.addClass("infinite-swipe-target"),this.options.infinite){var a=this.$target.clone().attr("aria-hidden",!0).addClass("infinite-swipe-target-clone").css("left","-"+100*this.options.total+"%"),b=this.$target.clone().attr("aria-hidden",!0).addClass("infinite-swipe-target-clone").css("left",100*this.options.total+"%");a.insertBefore(this.$target),b.insertBefore(this.$target),this.$target=this.$target.parent().find(".infinite-swipe-target")}this.addListeners(),!this.options.infinite&&this.options.$prev&&this.options.$prev.toggleClass("disabled",1===this.p),this.options.autoswipe_seconds>0&&this.initAutoswipe()},initAutoswipe:function(){var a=this;this._as_next=function(){a._as_timeout_id&&clearTimeout(a._as_timeout_id),a._as_timeout_id=setTimeout(function(){a._as_pause||a.swipeNext(),a._as_timeout_id=null,a._as_next()},1e3*a.options.autoswipe_seconds)},this._as_resume_event=function(){a._as_next()},this._as_pause_event=function(){a._as_timeout_id&&(clearTimeout(a._as_timeout_id),a._as_timeout_id=null)},this._as_next(),this.$autoswipe_pause_el.on("mouseenter focusin",this._as_pause_event).on("mouseleave focusout",this._as_resume_event)},onPrev:function(a){a.preventDefault(),a.stopPropagation(),(1!==this.p||this.options.infinite)&&this.swipePrev()},onNext:function(a){a.preventDefault(),a.stopPropagation(),(this.p!==this.total||this.options.infinite)&&this.swipeNext()},onDragLeft:function(b,c,d){if(!this._swiped){if(a(window).on("touchmove",this.disabled_touch),Math.abs(c)>5&&(this.p!==this.total||this.options.infinite))return b.preventDefault(),b.stopPropagation(),this._swiped=!0,this.curr_px=0,this._setTransitionDuration(0),void this.swipeNext();var e=d;this.animate_px(e)}},onDragRight:function(b,c,d){if(!this._swiped){if(a(window).on("touchmove",this.disabled_touch),Math.abs(c)>5&&(this.p!==this.total||this.options.infinite))return b.preventDefault(),b.stopPropagation(),this._swiped=!0,this.curr_px=0,this._setTransitionDuration(0),void this.swipePrev();var e=d;this.animate_px(e)}},onDragStart:function(){this._setTransitionDuration(0)},onDragEnd:function(){this._setTransitionDuration(this.options.transition_ms),this._swiped||this.animate(),this._swiped=!1,a(window).off("touchmove",this.disabled_touch)},onSwipeTotal:function(b,c){var d=this;this.total!==c&&(this.total=c,this.p>this.total&&(this.p=this.total),this.getWidth(!0),this.offset=0,this.animate(),this.$target.each(function(b){a(this).css("left",d.total*(d.offset+b)*100+"%")}))},onSwipePage:function(a,b){1>b||b>this.total||(this.p=b,this.animate())},onWindowResize:function(){var a=this;setTimeout(function(){var b=a.getWidth(),c=a.getWidth(!0);b!==c&&(a.$target_wrap.addClass("infinite-swipe-resizing"),a.animate(0,function(){a.$target_wrap.removeClass("infinite-swipe-resizing")}))},200)},addListeners:function(){var b=this,c="touchstart click",d=navigator.userAgent;d.indexOf("Android")>=0&&(c="touchstart"),this.options.$prev&&this.options.$prev.on(c,a.proxy(this.onPrev,this)),this.options.$next&&this.options.$next.on(c,a.proxy(this.onNext,this)),this._dragleft_event=function(){b.onDragLeft.apply(b,arguments)},this._dragright_event=function(){b.onDragRight.apply(b,arguments)},this._dragstart_event=function(){b.onDragStart.apply(b,arguments)},this._dragend_event=function(){b.onDragEnd.apply(b,arguments)},this._swipetotal_event=function(){b.onSwipeTotal.apply(b,arguments)},this._swipepage_event=function(){b.onSwipePage.apply(b,arguments)},this.$el.on("dragleft",this._dragleft_event).on("dragright",this._dragright_event).on("dragstart",this._dragstart_event).on("dragend",this._dragend_event).on("swipe_total",this._swipetotal_event).on("swipe_page",this._swipepage_event),this._resize_event=function(){b.onWindowResize()},a(window).on("resize orientationchange",this._resize_event)},removeListeners:function(){var b="touchstart click",c=navigator.userAgent;c.indexOf("Android")>=0&&(b="touchstart"),this.options.$prev&&this.options.$prev.off(b,a.proxy(this.onPrev,this)),this.options.$next&&this.options.$next.off(b,a.proxy(this.onNext,this)),this.$el.off("dragleft",this._dragleft_event).off("dragright",this._dragright_event).off("dragstart",this._dragstart_event).off("dragend",this._dragend_event).off("swipe_total",this._swipetotal_event).off("swipe_page",this._swipepage_event),a(window).off("resize orientationchange",this._resize_event)},getWidth:function(a){return(a||!this._w)&&(this._w=this.options.getWidth?this.options.getWidth():this.$target.width()),this._w},swipePrev:function(){this.animate(-1)},swipeNext:function(){this.animate(1)},animate:function(b,c){var d=this,e=this.p;b&&(this.p+=b),this.curr_px>30?this.p--:this.curr_px<-30&&this.p++,this.options.infinite?this.p===this.total+1?(this.p=1,this.offset++,this.$target.each(function(b){var c=d.total*(d.offset+b-1)*100;a(this).css("left",c+"%")})):0===this.p&&(this.p=this.total,this.offset--,this.$target.each(function(b){var c=d.total*(d.offset+b-1)*100;a(this).css("left",c+"%")})):this.p=Math.max(Math.min(this.p,this.total),1),this.curr_px=0;var g=-((this.p-1+this.offset*this.total)*this.getWidth(!0))/this.total;f(this.options.animation_type)(this.$target_wrap,g,this.options),this.options.infinite||(this.options.$prev&&this.options.$prev.toggleClass("disabled",1===this.p),this.options.$next&&this.options.$next.toggleClass("disabled",this.p===this.total)),this.options.$curr&&this.options.$curr.text(this.p),e!=this.p&&this.options.onPage&&this.options.onPage(this.p),c&&setTimeout(c,this.options.transition_ms)},animate_px:function(a){this.curr_px=a;var b=-((this.p-1+this.offset*this.total)*this.getWidth())/this.total+a;f(this.options.animation_type)(this.$target_wrap,b,this.options)},destroy:function(){this.$el.removeClass("infinite-swipe-stage"),this.$target_wrap.removeClass("infinite-swipe-target-wrap"),this.$target.filter(".infinite-swipe-target-clone").remove(),this.$el.find(".infinite-swipe-target").removeClass("infinite-swipe-target"),this.removeListeners(),this.options.autoswipe_seconds>0&&(this._as_timeout_id&&(clearTimeout(this._as_timeout_id),this._as_timeout_id=null),this.$el.off("mouseenter focusin",this._as_pause_event).off("mouseleave focusout",this._as_resume_event))},pause:function(){this._as_pause=!0},
resume:function(){this._as_pause=!1,this._as_next()}},a.fn.infiniteSwipeEvent=function(){var b,c=a(this),d=!1,e=null,f={x:null,y:null},g={x:null,y:null};c.on("touchstart",function(a){var c=a.originalEvent.touches[0].pageX,h=a.originalEvent.touches[0].pageY;d=!0,e=null,f.x=g.x=c,f.y=g.y=h,b=a.timeStamp}).on("touchend touchleave",function(){d&&c.trigger("dragend"),d=!1}).on("touchmove",function(a){if(d&&"y"!==e){var h=a.originalEvent.touches[0].pageX,i=a.originalEvent.touches[0].pageY,j={x:g.x-h,y:g.y-i};if(!e){if(e=Math.abs(j.x)>=Math.abs(j.y)?"x":"y","y"===e)return;c.trigger("dragstart")}var k=a.timeStamp-b,l={x:f.x-h,y:f.y-i},m=Math.abs(j.x/k);j.x>0?c.trigger("dragleft",[m,-l.x]):j.x<0&&c.trigger("dragright",[m,-l.x]),g.x=h,g.y=i,b=a.timeStamp}})},a.fn.infiniteSwipe=function(b){return this.each(function(){if("string"==typeof b){var c=a(this).data("infiniteswipe");c&&c[b]()}else a(this).infiniteSwipeEvent(),a(this).data("infiniteswipe",new g(a(this),b))})}})},{jquery:"jquery"}],jquery:[function(a,b){b.exports=window.$},{}]},{},[15]);